---
title: "Variable Selection Visualization"
author: "Lizzy Gibson"
date: "7/26/2018"
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
---

```{r setup, include=FALSE}
#install.packages("tidyverse")
library(tidyverse)
```

## Combine Effect Estimates

```{r}
#Need two periods to knit: "../"
#Need one period to run in console: "./"
#Or change file path to match your computer
grouped <- read_csv("../Variable Selection/grouped_betas.csv")
ind <- read_csv("../Variable Selection/ind_betas.csv")

plot_all <- rbind(grouped, ind) %>% filter(grepl("la$", variable)) 
```

## Compare Variable Selection Methods

```{r}
plot_all %>%
  ggplot(aes(x = method, y = round(beta, 5))) + geom_point(aes(color = method)) +
  theme_minimal() + geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position = "none") +
  facet_wrap( ~ variable) + coord_flip() + 
  labs(title = "Variable Selection Coefficients", 
       y = "Beta Coefficients",
       x = "Variable", 
       color = "Method")
```

### For Workshop Paper

```{r}
plot_all <- plot_all %>%
  mutate(group = case_when(variable == "lbx118la" ~ "TEQ",
                           grepl("lbxf|d", variable) == TRUE ~ "TEQ",
                           grepl("lbx1|0", variable) == TRUE ~ "Non-Dioxin-like PCB",
                           grepl("lbxh|p", variable) == TRUE ~ "Non-Ortho PCB"))
           
table(plot_all$variable, plot_all$group)                       
     
plot_all %>% 
  mutate(variable = as.factor(variable),
         group = as.factor(group),
         method = as.factor(method)) %>% 
  mutate(method = fct_relevel(method, c("Lasso", "Elastic Net", "Grouped Lasso"))) %>% 
  group_by(group) %>% 
  filter(method %in% c("Lasso", "Grouped Lasso", "Elastic Net")) %>% 
  ggplot(aes(x = variable, y = round(beta, 5))) + geom_point(aes(color = group)) +
  theme_minimal() + geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1), legend.position = "bottom") +
  facet_wrap( ~ method) + coord_flip() + 
  labs(title = "Variable Selection Coefficients", 
       y = "Beta Coefficients",
       x = "Variables", 
       color = "POP Group")
```

