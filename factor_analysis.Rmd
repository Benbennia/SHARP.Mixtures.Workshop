---
title: "Mixtures Workshop: Factor Analysis"
author: "Lizzy Gibson"
date: "8/9/2018"
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#install.packages("tidyverse")
library(tidyverse)
#install.packages("janitor")
library(janitor)

#This turns off scientific notation
options(scipen = 999)
```

## Data
```{r clean}
studypop <- read_csv("./Data/studypop.csv") %>% clean_names() %>% na.omit() %>% 
  select(3:8, 17:24) #only include pollutants for FA, remove outcome and covariates

studypop <- log(studypop) #log transform variables
```

## Factor Analysis
```{r}
fa_2 <- factanal(studypop, 
                 factors = 2,
                 rotation = "varimax", #varimax is an orthogonal rotation
                 scores = "regression")

print(fa_2, digits = 2, cut.off = .2, sort = TRUE)
```

